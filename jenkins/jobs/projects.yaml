- project:
    name: tesora-api-site
    node: bare-trusty

    jobs:
      - openstack-doc-jobs
      - manual-translation-jobs

- project:
    name: tesora-horizon
    node: bare-trusty
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - python-jobs
      - python-kilo-bitrot-jobs
      - python-liberty-bitrot-jobs
      - openstack-publish-jobs
      - javascript-jobs
      - translation-jobs
      - translation-jobs-liberty
      - openstack-releasenotes-jobs
      - gate-{name}-tox-{envlist}:
          envlist:
            - py27dj18
            - py27dj19

- project:
    name: tesora-nodepool
    node: bare-trusty
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org
    doc-publisher-folder: nodepool

    jobs:
      - python-jobs
      - pypi-jobs
      - infra-publish-jobs
      - '{pipeline}-dsvm-nodepool{job-suffix}':
          pipeline: gate
          node: devstack-trusty
          job-suffix: ''
          branch-override: 'default'
      - '{pipeline}-dsvm-nodepool-src-shade{job-suffix}':
          pipeline: gate
          node: devstack-trusty
          job-suffix: ''
          branch-override: 'default'

- project:
    name: tesora-openstack-doc-tools
    node: bare-trusty
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - python-jobs
      - pypi-jobs
      - openstack-releasenotes-jobs

- project:
    name: tesora-openstack-manuals
    node: bare-trusty

    jobs:
      - openstack-doc-jobs
      - manual-translation-jobs
      - translation-jobs-liberty

- project:
    name: tesora-project-config
    node: bare-trusty

    jobs:
      - gate-{name}-linters
      - generate-specs-site-jobs
      - gate-bindep-fallback-{node}:
          node:
            - devstack-centos7
            - fedora-23
            - ubuntu-trusty

- project:
    name: tesora-python-troveclient
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org
    node: bare-trusty

    jobs:
      - python-jobs
      - openstack-publish-jobs
      - pypi-jobs
      - '{pipeline}-tempest-dsvm-neutron-src-tesora-python-troveclient{job-suffix}':
          pipeline: gate
          node: devstack-trusty
          job-suffix: ''
          branch-override: default

- project:
    name: tesora-requirements
    node: bare-trusty
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - gate-{name}-docs
      - gate-{name}-pep8
      - gate-{name}-python27
      - gate-{name}-pypy
      - openstack-publish-jobs
      - propose-requirements-constraints{job-suffix}:
          job-suffix: '-master'
          branch-override: master
      - propose-requirements-constraints{job-suffix}:
          job-suffix: '-EE-1.6'
          branch-override: dev/EE-1.6
      - 'gate-{name}-tox-{envlist}':
          envlist: validate
      # This is a periodic job to ensure that our wheels are reasonably
      # up-to-date. Adding it to the requirements project seems to be the best
      # place to put it, though it's not strictly a requirement for
      # requirements.
      - wheel-build-{node_arch}:
          node_arch:
            - ubuntu-trusty-amd64
      - wheel-release-{mirror_arch}:
          mirror_arch:
            - trustyx64

- project:
    name: requirements-jobs

    jobs:
      - '{pipeline}-tesora-requirements-integration-dsvm{variant}':
          pipeline: gate
          node: devstack-trusty
          variant: ''
      - '{pipeline}-tesora-requirements-integration-dsvm{variant}':
          pipeline: gate
          node: devstack-trusty
          variant: '-resolver'
      - '{pipeline}-pbr-installation-dsvm{variant}':
          pipeline: gate
          node: devstack-trusty
          variant: ''
      - '{pipeline}-pbr-installation-dsvm{variant}':
          pipeline: gate
          node: devstack-trusty
          variant: '-upstream'
      - '{pipeline}-pbr-installation-dsvm{variant}':
          pipeline: periodic
          node: devstack-trusty
          variant: '-upstream'

- project:
    name: tesora-config
    node: bare-trusty
    doc-publisher-site: docs.elasticdb.org
    doc-publisher-folder: system-config

    jobs:
      - puppet-check-jobs:
      - gate-{name}-linters
      - gate-infra-puppet-apply-{ostype}:
          ostype:
            - bare-precise
            - bare-trusty
            - fedora-23
      - gate-infra-puppet-apply-dsvm-{ostype}:
          ostype:
            - centos7
      - infra-publish-jobs
      - 'gate-{name}-docs'

- project:
    name: tesora-trove
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org
    node: bare-trusty

    jobs:
      - python-jobs
      - python-kilo-bitrot-jobs
      - python-liberty-bitrot-jobs
      - openstack-publish-jobs
      - translation-jobs
      - openstack-releasenotes-jobs
      - openstack-doc-jobs
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'percona'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mongodb'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: '-EE-1.7'
          branch-override: dev/EE-1.7
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: '-EE-1.6'
          branch-override: dev/EE-1.6
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: '-CE-1.6'
          branch-override: dev/CE-1.6
      - 'gate-tesora-trove-buildimage-{datastore}':
          datastore: 'mysql'
      - 'gate-tesora-trove-buildimage-{datastore}':
          datastore: 'percona'
      - 'gate-tesora-trove-buildimage-{datastore}':
          datastore: 'mongodb'
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'percona'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'pxc'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'mariadb'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'mongodb'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'redis'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'cassandra'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'dse'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'couchbase'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'postgresql'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'couchdb'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'vertica'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'db2'
          job-suffix: ''
          branch-override: default

- project:
    name: tesora-trove-dashboard
    node: bare-trusty
    tarball-site: tarballs.elasticdb.org

    jobs:
      - python-jobs
      - pypi-jobs
      - translation-jobs

- project:
    name: tesora-trove-specs
    node: bare-trusty

    jobs:
      - specs-jobs

- project:
    name: tesora-dbaas-tools
    node: 'bare-trusty'

    jobs:
      - gate-{name}-bashate

- project:
    name: tesora-qa
    node: 'bare-trusty'

    jobs:
      - gate-{name}-bashate

- project:
    name: devstack-jobs

    jobs:
      # Normal gate and check jobs
      - devstack-jobs:
          pipeline: gate
          node: devstack-trusty
          job-suffix: ''
          branch-override: default
      # Stable gate jobs for branchless tempest
      - devstack-jobs:
          pipeline: gate
          node: devstack-trusty
          job-suffix: '-EE-1.5'
          branch-override: dev/EE-1.5
      - devstack-jobs:
          pipeline: gate
          node: devstack-trusty
          job-suffix: '-EE-1.6'
          branch-override: dev/EE-1.6
      # Stable check jobs for testing devstack gate
      # tempest also uses these job definitions
      - devstack-jobs:
          pipeline: gate
          node: devstack-trusty
          job-suffix: '-EE-1.5-nv'
          branch-override: dev/EE-1.5
      - devstack-jobs:
          pipeline: gate
          node: devstack-trusty
          job-suffix: '-EE-1.6-nv'
          branch-override: dev/EE-1.6
      # Periodic jobs for various branches
      - devstack-jobs:
          pipeline: periodic
          node: devstack-trusty
          job-suffix: '-EE-1.5'
          branch-override: dev/EE-1.5
      - devstack-jobs:
          pipeline: periodic
          node: devstack-trusty
          job-suffix: '-EE-1.6'
          branch-override: dev/EE-1.6
      - devstack-jobs:
          pipeline: periodic
          node: devstack-trusty
          job-suffix: '-master'
          branch-override: master
      # Special jobs for devstack-gate
      - devstack-gate-jobs:
          node: devstack-trusty
      - '{pipeline}-grenade-dsvm-multinode{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-grenade-dsvm-multinode{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: '-nv'
          branch-override: default
      - '{pipeline}-{name}-src-grenade-dsvm-multinode{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-{name}-src-grenade-dsvm-multinode{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: '-nv'
          branch-override: default
      - '{pipeline}-tempest-dsvm-multinode-full{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-tempest-dsvm-neutron-multinode-full{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-tempest-dsvm-neutron-dvr-multinode-full{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-tempest-dsvm-multinode-live-migration{job-suffix}':
          pipeline: gate
          node: devstack-trusty-2-node
          job-suffix: ''
          branch-override: default
      # Experimental jobs for testing dib images.
      - '{pipeline}-tempest-dsvm-full{job-suffix}':
          pipeline: experimental
          node: ubuntu-trusty
          job-suffix: '-dibtest'
          branch-override: default
      - '{pipeline}-tempest-dsvm-neutron-full{job-suffix}':
          pipeline: experimental
          node: ubuntu-trusty
          job-suffix: '-dibtest'
          branch-override: default
      - '{pipeline}-tempest-dsvm-multinode-full{job-suffix}':
          pipeline: experimental
          node: ubuntu-trusty-2-node
          job-suffix: '-dibtest'
          branch-override: default
      # fedora jobs
      - '{pipeline}-tempest-dsvm-f{fedora-release}':
          fedora-release: 23
          pipeline: gate
          node: fedora-23
