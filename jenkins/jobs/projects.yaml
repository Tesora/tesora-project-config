- project:
    name: tesora-api-site

    jobs:
      - openstack-doc-jobs
      - manual-translation-jobs

- project:
    name: tesora-horizon
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - coverage-jobs
      - python-jobs
      - python-liberty-bitrot-jobs
      - python-mitaka-bitrot-jobs
      - openstack-publish-jobs
      - openstack-releasenotes-jobs
      - openstack-server-release-jobs
      - translation-jobs
      - translation-jobs-mitaka
      - javascript-jobs
      - 'gate-{name}-python35{suffix}':
          suffix: '-nv'
      - gate-{name}-tox-{envlist}:
          envlist:
            - py27dj18
            - py27dj19

- project:
    name: tesora-nodepool
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org
    doc-publisher-folder: nodepool

    jobs:
      - coverage-db-jobs
      - python-db-jobs
      - 'gate-{name}-python35-db{suffix}':
          suffix: '-nv'
      - pypi-jobs
      - infra-publish-jobs
      - '{pipeline}-dsvm-nodepool{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: ''
          branch-override: 'default'
      - '{pipeline}-dsvm-nodepool-src-shade{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: ''
          branch-override: 'default'

- project:
    name: tesora-openstack-doc-tools
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - python-jobs
      - pypi-jobs
      - openstack-releasenotes-jobs

- project:
    name: tesora-openstack-manuals
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - openstack-doc-jobs
      - openstack-releasenotes-jobs
      - manual-translation-jobs
      - translation-jobs-liberty
      - translation-jobs-mitaka

- project:
    name: tesora-project-config

    jobs:
      - bindep-fallback-tests
      - gate-{name}-linters
      - generate-specs-site-jobs

- project:
    name: tesora-python-troveclient
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org


    jobs:
      - python-jobs
      - 'gate-{name}-pypy'
      - 'gate-{name}-python35{suffix}':
          suffix: '-nv'
      - openstack-client-publish-jobs
      - pypi-jobs
      - openstack-releasenotes-jobs
      - '{pipeline}-tempest-dsvm-neutron-src-tesora-python-troveclient{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: ''
          branch-override: default


- project:
    name: tesora-requirements
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - gate-{name}-docs
      - gate-{name}-pep8
      - gate-{name}-python27
      - gate-{name}-pypy
      - openstack-publish-jobs
      - propose-requirements-constraints{job-suffix}:
          job-suffix: '-master'
          branch-override: master
      - 'gate-{name}-tox-{envlist}':
          envlist: validate
      - 'gate-{name}-tox-{envlist}':
          envlist: validate-projects
      - 'gate-{name}-tox-{envlist}':
          envlist: babel
      - 'gate-{name}-tox-{envlist}':
          envlist: py27-with-upper-constraints
      # This is a periodic job to ensure that our wheels are reasonably
      # up-to-date. Adding it to the requirements project seems to be the best
      # place to put it, though it's not strictly a requirement for
      # requirements.
      - wheel-build-{node_arch}-{python}:
          node_arch:
            - centos-7-amd64
            - ubuntu-trusty-amd64
            - ubuntu-xenial-amd64
          python:
            - python2
            - python3
      - wheel-release-{mirror_arch}:
          mirror_arch:
            - cent7x64
            - trustyx64
            - xenialx64

- project:
    name: requirements-jobs

    jobs:
      - '{pipeline}-tesora-requirements-integration-dsvm{variant}':
          pipeline: gate
          node: ubuntu-trusty
          variant: ''
      - '{pipeline}-tesora-requirements-integration-dsvm{variant}':
          pipeline: gate
          node: ubuntu-trusty
          variant: '-resolver'
      - '{pipeline}-pbr-installation-dsvm{variant}':
          pipeline: gate
          node: ubuntu-trusty
          variant: ''
      - '{pipeline}-pbr-installation-dsvm{variant}':
          pipeline: gate
          node: ubuntu-trusty
          variant: '-upstream'

- project:
    name: tesora-config
    doc-publisher-site: docs.elasticdb.org
    doc-publisher-folder: system-config


    jobs:
      - puppet-check-jobs:
      - gate-{name}-linters
      - gate-infra-puppet-apply-{node}:
          node:
            - centos-7
            - debian-jessie
            - ubuntu-precise
            - ubuntu-trusty
            - ubuntu-xenial
            - fedora-23
      - infra-publish-jobs
      - 'gate-{name}-docs'

- project:
    name: tesora-trove
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.elasticdb.org

    jobs:
      - coverage-db-jobs
      - python-db-jobs
      - 'gate-{name}-python35-db{suffix}':
          suffix: '-nv'
      - python-liberty-bitrot-db-jobs
      - python-mitaka-bitrot-db-jobs
      - openstack-server-release-jobs
      - openstack-publish-jobs
      - openstack-releasenotes-jobs
      - translation-jobs
      - openstack-doc-jobs
      - install-guide-jobs:
          service: database
      - periodic-python-jobs-with-oslo-master
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: '-EE-1.9'
          branch-override: dev/EE-1.9
      - 'gate-tesora-trove-functional-dsvm-{datastore}{job-suffix}':
          datastore: 'mysql'
          job-suffix: '-EE-1.8'
          branch-override: dev/EE-1.8
      - 'gate-tesora-trove-buildimage-{datastore}':
          datastore: 'mysql'
      - 'gate-tesora-trove-buildimage-{datastore}':
          datastore: 'percona'
      - 'gate-tesora-trove-buildimage-{datastore}':
          datastore: 'mongodb'
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'percona'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'pxc'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'mariadb'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'mongodb'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'redis'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'cassandra'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'dse'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'couchbase'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'postgresql'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'couchdb'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'vertica'
          job-suffix: ''
          branch-override: default
      - 'gate-tesora-trove-scenario-dsvm-{datastore}{job-suffix}':
          datastore: 'db2'
          job-suffix: ''
          branch-override: default

- project:
    name: tesora-trove-dashboard
    tarball-site: tarballs.elasticdb.org
    doc-publisher-site: docs.openstack.org

    jobs:
      - coverage-jobs
      - python-jobs
      - pypi-jobs
      - translation-jobs
      - translation-jobs-mitaka
      - openstack-releasenotes-jobs

- project:
    name: tesora-trove-specs

    jobs:
      - specs-jobs

- project:
    name: tesora-dbaas-tools

    jobs:
      - gate-{name}-bashate

- project:
    name: tesora-qa

    jobs:
      - gate-{name}-bashate

- project:
    name: devstack-jobs

    jobs:
      # Normal gate and check jobs
      - devstack-jobs:
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: ''
          branch-override: default
      # Experimental jobs for ubuntu-xenial
      - devstack-jobs:
          pipeline: experimental
          node: ubuntu-xenial
          job-suffix: ''
          branch-override: default
      # Stable gate jobs for branchless tempest
      - devstack-stable-jobs:
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-EE-1.5'
          branch-override: dev/EE-1.5
      - devstack-stable-jobs:
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-EE-1.6'
          branch-override: dev/EE-1.6
      # Stable check jobs for testing devstack gate
      # tempest also uses these job definitions
      - devstack-stable-jobs:
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-EE-1.5-nv'
          branch-override: dev/EE-1.5
      - devstack-stable-jobs:
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-EE-1.6-nv'
          branch-override: dev/EE-1.6
      # Periodic jobs for various branches
      - devstack-stable-jobs:
          pipeline: periodic
          node: ubuntu-trusty
          job-suffix: '-EE-1.5'
          branch-override: dev/EE-1.5
      - devstack-stable-jobs:
          pipeline: periodic
          node: ubuntu-trusty
          job-suffix: '-EE-1.6'
          branch-override: dev/EE-1.6
      - devstack-periodic-master-jobs:
          pipeline: periodic
          node: ubuntu-trusty
          job-suffix: '-master'
          branch-override: master
      # Special jobs for devstack-gate
      - devstack-gate-jobs:
          node: ubuntu-trusty
      - '{pipeline}-grenade-dsvm-multinode{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-grenade-dsvm-multinode{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty-2-node
          job-suffix: '-nv'
          branch-override: default
      - '{pipeline}-tempest-dsvm-multinode-full{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-tempest-dsvm-neutron-identity-v3-only-full{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-nv'
          branch-override: default
      - '{pipeline}-tempest-dsvm-neutron-multinode-full{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-tempest-dsvm-neutron-dvr-multinode-full{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty-2-node
          job-suffix: ''
          branch-override: default
      - '{pipeline}-tempest-dsvm-multinode-live-migration{job-suffix}':
          pipeline: gate
          node: ubuntu-xenial-2-node
          job-suffix: ''
          branch-override: default
      # Experimental job for testing Nova with os-vif library
      - '{pipeline}-tempest-dsvm-nova-os-vif{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-nv'
          branch-override: default
      - '{pipeline}-tempest-dsvm-nova-libvirt-kvm-apr{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: ''
          branch-override: default
      # Experimental jobs for testing dib images.
      - '{pipeline}-tempest-dsvm-full{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-dibtest'
          branch-override: default
      - '{pipeline}-tempest-dsvm-neutron-full{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty
          job-suffix: '-dibtest'
          branch-override: default
      - '{pipeline}-tempest-dsvm-multinode-full{job-suffix}':
          pipeline: gate
          node: ubuntu-trusty-2-node
          job-suffix: '-dibtest'
          branch-override: default
      - '{pipeline}-tempest-dsvm-platform-{name}{job-suffix}':
          name: centos7
          pipeline: gate
          node: centos-7
          neutron: 0
          job-suffix: '-nv'
      - '{pipeline}-tempest-dsvm-platform-{name}{job-suffix}':
          name: fedora23
          pipeline: gate
          node: fedora-23
          neutron: 0
          job-suffix: '-nv'
